<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<TITLE>
BackgroundEmailer
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="stylesheet.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="BackgroundEmailer";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">  <A HREF="overview-summary-BackgroundEmailer.jsx.html"><FONT CLASS="NavBarFont1"><B>File</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev">&nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <!--TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1"-->    <!--A HREF="deprecated-list.html"--><!--FONT CLASS="NavBarFont1">Deprecated</FONT--><!--/A--><!--&nbsp;</TD-->
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="index-all.html"--><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<B>AdobeBridgeCS6SDK</B>
</EM>
</TD
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="AsynchronousFTP.html"><B>PREV CLASS</B></A><!-- 
   NEXT CLASS 
-->
&nbsp;<A HREF="BasicEmailer.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BackgroundEmailer.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->
<HR>

<!-- ======== START OF CLASS DATA ======== -->
<H2>Class BackgroundEmailer</H2>
<PRE>Object
   |
   +--<b>BackgroundEmailer</b>
</PRE>


<HR>
<DL>
   <!-- Class definition -->
   <DT>class 
   <B>BackgroundEmailer</B>
   

</DL>
   
   <P>
   <BR/>Sample using the Socket object to send email with attachments as a background (scheduled) task.
 
  <h4>Usage</h4>
   <b>You must</b> edit the mailserver settings within this code; the code as shipped does not provide any default
  values for these settings and if you do not edit these settings in the code (see "NOTE" below),
  then the code will not run correctly. 

  <ol>
   <li> Customize the email settings in the code to match your mail system and user accounts; look for NOTE below.
   <li> Execute the snippet in the ExtendScript Toolkit, with Bridge as the target (see Readme.txt)
   <li>You should find this creates a context-sensitive menu item on selected file thumbnails.
   <li> In the Content pane of Bridge, select one or more thumbnails for the files to send.
   <li> Right click in Windows or Ctrl-click in Mac OS to invoke the context menu
   <li> Choose the menu item "SDK BackgroundEmailer: Send by Email"
   <li> Inspect the JavaScript console for confirmation of the email being sent.
   <li> Check your email client for the arrival of an email with attached files
   </ol>

  <h4>Description</h4>

<p>This example uses the Socket object to send an email with multiple attachments, uing a scheduled task
to perform encoding and send the data in the background.
  It sends just one email message at a time. Attachments are sent as binary data. 
  
<p>This example schedules a task to encode the  data into Base64 encoding and
  write to the SMTP server as a background task, which does not block the 
  Bridge main thread. The Bridge browser functions normally  while the email 
  and files are being sent. Static properties provide operation status updates within 
  the scheduleTask() call. 
  
<p>When the send() method is called, the mail headers are written to the socket and a task named sendData() is scheduled to 
  run and to repeat every 10 milliseconds. Whilst the task is in operation, a file to be attached is read as a binary 
  string, encoded and written to the socket in chunks at a time.  When the last chunk of the last file has been transmitted, 
  the task is cancelled and the socket is closed.
 
<p>You should be aware that this sample is a demonstration of technique; it may not run as expected with 
  	all mail servers, and it is not intended as a robust mail client.
  
<p>For a blocking example, which might be suitable when sending smaller files as attachments, see BasicEmailer.jsx.<br />
  
  <BR/><B>See:</B><UL>- <a href="BasicEmailer.html#">BasicEmailer</a></UL><I>Defined in <a href='overview-summary-BackgroundEmailer.jsx.html'>BackgroundEmailer.jsx</a></I><BR/><BR/>
   </P>
   
   <HR>

<!-- ======== NESTED CLASS SUMMARY ======== -->

<!-- ======== END NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->

   <A NAME="field_summary"><!-- --></A>
      <TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
         <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
            <TD COLSPAN=2><FONT SIZE="+2">
               <B>Field Summary</B></FONT></TD>
         </TR>

   <!-- This is one instance field summary -->
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#requiredContext">requiredContext</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The context in which this snippet can run.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!b64Chars">b64Chars</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The 64 characters used to encode the files to Base64.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!boundary">boundary</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The boundary marker for attachments.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!contents">contents</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The binary contents of a file to be attached to the email.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Number</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!encodeTaskID">encodeTaskID</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of the scheduled task that will encode and transmit data, 
	 needed to cancel the task after it has finished.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Boolean</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!finishedAttachment">finishedAttachment</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flag that indicates when an attachment has been transmitted.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!isRunning">isRunning</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flag that indicates whether or not an email operation is underway</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!mailServerName">mailServerName</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The host address for the mail server, for example mail.adomainname.com - 
	 NOTE: You must customize this with your own mailserver.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Socket</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!password">password</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The password for the username - NOTE: You must customize this with your own 
	 password for your (POP3) mail server.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;int</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!POP">POP</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The port number for the POP server, for example port 110 - 
	 NOTE: You may want to customize this for your system.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!recipient">recipient</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The address the email will be sent to, the receiver of the email - 
	 NOTE: You must customize this with your own target recipient.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!sender">sender</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The senders email address, for example testemail</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;int</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!SMTP">SMTP</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The port number for the SMTP server, for example port 25 - 
	 NOTE: You may want to customize this for your system.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Socket</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!socket">socket</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Socket object that this object uses to write to the wire.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Boolean</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!startAttach">startAttach</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flag that indicates when we are at the start of the process of
        attaching a new file.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!subject">subject</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The subject of the email.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;Array of Thumbnail</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!Thumbnails">Thumbnails</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The selected thumbnails for the files to be attached.</TD>
   </TR>
   
   <TR BGCOLOR="white" CLASS="TableRowColor">
   <TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
   <CODE>&lt;static&gt; &nbsp;String</CODE></FONT></TD>
   <TD><CODE><B><A HREF="#!s!username">username</A></B></CODE>
   <BR>
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The username, not necessarily the senders email, to authorize with, for example 
	 testemail</TD>
   </TR>
   

   </TABLE>
   &nbsp;
   

   

<!-- =========== END FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
   <TD>
      <CODE>
	 <B>
	    <A HREF="BackgroundEmailer.html#BackgroundEmailer()">BackgroundEmailer</A> 
	 </B>
	 ()
      </CODE>
      <BR>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      
      </TD>
</TR>
</TABLE>

<!-- ======== END CONSTRUCTOR SUMMARY ======== -->

&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>


   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&nbsp;Boolean</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#canRun">canRun</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Determines whether snippet can be run given current context.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&nbsp;Boolean</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#run">run</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Functional part of this snippet.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;void</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!authorise">authorise</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Authorizes a username against POP3.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;void</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!buildMessageBody">buildMessageBody</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Constructs a simple message for the body of the email showing which files are attached
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;void</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!close">close</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Close the socket that was used to transmit data
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;Boolean</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!connect">connect</A></B>(host, port)
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Attempts to open a socket and connect to a given host and port.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;Boolean</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!doCommand">doCommand</A></B>(cmd, type)
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Executes an SMTP or a POP command.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;String</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!encodeString">encodeString</A></B>(binaryString)
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Accepts a string representing a binary file and encodes the string to base64.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;void</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!finishEmail">finishEmail</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Ends the transmission; writes the last part of the boundary, sends the
  necessary SMTP commands and closes the socket.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;String</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!nextChunk">nextChunk</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Get the next chunk of data from the binary contents of the 
  current file that is to be attached to the email
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;void</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!send">send</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 Sends the email and attachments by connecting to the server and authorizing via POP.
      </TD>
   </TR>

   <TR BGCOLOR="white" CLASS="TableRowColor">
      <TD ALIGN="right" VALIGN="top" WIDTH="1%">
	 <FONT SIZE="-1">
	    <CODE>&lt;static&gt;&nbsp;Boolean</CODE>
	 </FONT>
      </TD>
      <TD>
	 <CODE>
	    <B>
	       <A HREF="#!s!sendData">sendData</A></B>()
	 </CODE>
	 <BR>
	 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	 This is the task to send the attachment data, 
 which is scheduled to run by the BackgroundEmailer.send() method.
      </TD>
   </TR>


</TABLE>



<P>
<!-- ========== END METHOD SUMMARY =========== -->


<!-- ============ FIELD DETAIL START =========== -->

   <A NAME="field_detail"><!-- --></A>
   <TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
      <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
         <TD COLSPAN=1><FONT SIZE="+2"><B>Field Detail</B></FONT></TD>
      </TR>
   </TABLE>

   
   <A NAME="requiredContext"><!-- --></A>
   <H3>requiredContext</H3>
   <PRE>String&nbsp;<B>requiredContext</B></PRE>
   <UL>
   The context in which this snippet can run.
   
   </UL>
   <HR>
   
   <A NAME="!s!b64Chars"><!-- --></A>
   <H3>b64Chars</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>b64Chars</B></PRE>
   <UL>
   The 64 characters used to encode the files to Base64.
   
   </UL>
   <HR>
   
   <A NAME="!s!boundary"><!-- --></A>
   <H3>boundary</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>boundary</B></PRE>
   <UL>
   The boundary marker for attachments.
   
   </UL>
   <HR>
   
   <A NAME="!s!contents"><!-- --></A>
   <H3>contents</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>contents</B></PRE>
   <UL>
   The binary contents of a file to be attached to the email.
   
   </UL>
   <HR>
   
   <A NAME="!s!encodeTaskID"><!-- --></A>
   <H3>encodeTaskID</H3>
   <PRE>&lt;static&gt;&nbsp;Number&nbsp;<B>encodeTaskID</B></PRE>
   <UL>
   The ID of the scheduled task that will encode and transmit data, 
	 needed to cancel the task after it has finished.
   
   </UL>
   <HR>
   
   <A NAME="!s!finishedAttachment"><!-- --></A>
   <H3>finishedAttachment</H3>
   <PRE>&lt;static&gt;&nbsp;Boolean&nbsp;<B>finishedAttachment</B></PRE>
   <UL>
   Flag that indicates when an attachment has been transmitted.
   
   </UL>
   <HR>
   
   <A NAME="!s!isRunning"><!-- --></A>
   <H3>isRunning</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>isRunning</B></PRE>
   <UL>
   Flag that indicates whether or not an email operation is underway
   
   </UL>
   <HR>
   
   <A NAME="!s!mailServerName"><!-- --></A>
   <H3>mailServerName</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>mailServerName</B></PRE>
   <UL>
   The host address for the mail server, for example mail.adomainname.com - 
	 NOTE: You must customize this with your own mailserver.
   
   </UL>
   <HR>
   
   <A NAME="!s!password"><!-- --></A>
   <H3>password</H3>
   <PRE>&lt;static&gt;&nbsp;Socket&nbsp;<B>password</B></PRE>
   <UL>
   The password for the username - NOTE: You must customize this with your own 
	 password for your (POP3) mail server.
   
   </UL>
   <HR>
   
   <A NAME="!s!POP"><!-- --></A>
   <H3>POP</H3>
   <PRE>&lt;static&gt;&nbsp;int&nbsp;<B>POP</B></PRE>
   <UL>
   The port number for the POP server, for example port 110 - 
	 NOTE: You may want to customize this for your system.
   
   </UL>
   <HR>
   
   <A NAME="!s!recipient"><!-- --></A>
   <H3>recipient</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>recipient</B></PRE>
   <UL>
   The address the email will be sent to, the receiver of the email - 
	 NOTE: You must customize this with your own target recipient.
   
   </UL>
   <HR>
   
   <A NAME="!s!sender"><!-- --></A>
   <H3>sender</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>sender</B></PRE>
   <UL>
   The senders email address, for example testemail
   
   </UL>
   <HR>
   
   <A NAME="!s!SMTP"><!-- --></A>
   <H3>SMTP</H3>
   <PRE>&lt;static&gt;&nbsp;int&nbsp;<B>SMTP</B></PRE>
   <UL>
   The port number for the SMTP server, for example port 25 - 
	 NOTE: You may want to customize this for your system.
   
   </UL>
   <HR>
   
   <A NAME="!s!socket"><!-- --></A>
   <H3>socket</H3>
   <PRE>&lt;static&gt;&nbsp;Socket&nbsp;<B>socket</B></PRE>
   <UL>
   The Socket object that this object uses to write to the wire.
   
   </UL>
   <HR>
   
   <A NAME="!s!startAttach"><!-- --></A>
   <H3>startAttach</H3>
   <PRE>&lt;static&gt;&nbsp;Boolean&nbsp;<B>startAttach</B></PRE>
   <UL>
   Flag that indicates when we are at the start of the process of
        attaching a new file.
   
   </UL>
   <HR>
   
   <A NAME="!s!subject"><!-- --></A>
   <H3>subject</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>subject</B></PRE>
   <UL>
   The subject of the email.
   
   </UL>
   <HR>
   
   <A NAME="!s!Thumbnails"><!-- --></A>
   <H3>Thumbnails</H3>
   <PRE>&lt;static&gt;&nbsp;Array of Thumbnail&nbsp;<B>Thumbnails</B></PRE>
   <UL>
   The selected thumbnails for the files to be attached.
   
   </UL>
   <HR>
   
   <A NAME="!s!username"><!-- --></A>
   <H3>username</H3>
   <PRE>&lt;static&gt;&nbsp;String&nbsp;<B>username</B></PRE>
   <UL>
   The username, not necessarily the senders email, to authorize with, for example 
	 testemail
   
   </UL>
   <HR>
   


<!-- ============ FIELD DETAIL END =========== -->

    <!-- ========= CONSTRUCTOR DETAIL START ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
   <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
      <TD COLSPAN=1>
      <FONT SIZE="+2"><B>Constructor Detail</B></FONT>
      </TD>
   </TR>
</TABLE>

<A NAME="BackgroundEmailer()"><!-- --></A><H3>
BackgroundEmailer</H3>
<PRE><B>BackgroundEmailer</B>()</PRE>




   </UL>


<!-- Constructor return value(s) -->

<!-- End constructor return value(s) -->

<!-- ADDITIONAL ATTRIBUTES -->

<UL>   
<B>See:</B><UL>- <a href="BasicEmailer.html#">BasicEmailer</a></UL>
</UL>

<HR/>
<!-- END ADDITIONAL ATTRIBUTES  -->

<!-- ========= CONSTRUCTOR DETAIL END ======== -->


<!-- ============ METHOD DETAIL START ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
   <TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
      <TD COLSPAN=1><FONT SIZE="+2">
         <B>Method Detail</B></FONT>
      </TD>
   </TR>
</TABLE>

<!-- One single method detail entry -->

   <A NAME="canRun"><!-- --></A>
   <H3>canRun</H3>
   <PRE>Boolean <B>canRun</B>()</PRE>
   
      <UL>Determines whether snippet can be run given current context.  The snippet 
 fails if these preconditions are not met:
 <ul>
 <li> Bridge must be running
 </ul></UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        True if this snippet can run, false otherwise  	 
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="run"><!-- --></A>
   <H3>run</H3>
   <PRE>Boolean <B>run</B>()</PRE>
   
      <UL>Functional part of this snippet.

 Runs this sample, calling the helper functions defined below.
 Creates the Socket object and applies mail settings, such as hostname, 
 password, and so on. You must customize the code so that the mail 
 settings correspond to your mail system and user accounts; otherwise, 
 the sample fails and no emails are sent.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        True if the sample ran as expected, false otherwise   
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!authorise"><!-- --></A>
   <H3>authorise</H3>
   <PRE>&lt;static&gt; void <B>authorise</B>()</PRE>
   
      <UL>Authorizes a username against POP3.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!buildMessageBody"><!-- --></A>
   <H3>buildMessageBody</H3>
   <PRE>&lt;static&gt; void <B>buildMessageBody</B>()</PRE>
   
      <UL>Constructs a simple message for the body of the email showing which files are attached</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!close"><!-- --></A>
   <H3>close</H3>
   <PRE>&lt;static&gt; void <B>close</B>()</PRE>
   
      <UL>Close the socket that was used to transmit data</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!connect"><!-- --></A>
   <H3>connect</H3>
   <PRE>&lt;static&gt; Boolean <B>connect</B>(host, port)</PRE>
   
      <UL>Attempts to open a socket and connect to a given host and port.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <UL>
   <B>Parameters:</B>
   
     <UL><CODE>host</CODE> -  The server host name string.  
      </UL> 
   
     <UL><CODE>port</CODE> -  The port number, an integer.  
      </UL> 
   
   </UL>
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        True if the socket opened successfully, false otherwise   
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!doCommand"><!-- --></A>
   <H3>doCommand</H3>
   <PRE>&lt;static&gt; Boolean <B>doCommand</B>(cmd, type)</PRE>
   
      <UL>Executes an SMTP or a POP command.  Separates writing data to the socket and sending commands.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <UL>
   <B>Parameters:</B>
   
     <UL><CODE>cmd</CODE> -  The command to be written to the socket  
      </UL> 
   
     <UL><CODE>type</CODE> -  One of 'pop' or 'smtp'  
      </UL> 
   
   </UL>
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        True if the command was executed correctly   
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!encodeString"><!-- --></A>
   <H3>encodeString</H3>
   <PRE>&lt;static&gt; String <B>encodeString</B>(binaryString)</PRE>
   
      <UL>Accepts a string representing a binary file and encodes the string to base64.
 "Base64 Content-Transfer-Encoding" as per RFC 1521 (http://www.ietf.org/rfc/rfc1521.txt)</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <UL>
   <B>Parameters:</B>
   
     <UL><CODE>binaryString</CODE> -  The string to encode  
      </UL> 
   
   </UL>
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        The base64-encoded string. 
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!finishEmail"><!-- --></A>
   <H3>finishEmail</H3>
   <PRE>&lt;static&gt; void <B>finishEmail</B>()</PRE>
   
      <UL>Ends the transmission; writes the last part of the boundary, sends the
  necessary SMTP commands and closes the socket.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!nextChunk"><!-- --></A>
   <H3>nextChunk</H3>
   <PRE>&lt;static&gt; String <B>nextChunk</B>()</PRE>
   
      <UL>Get the next chunk of data from the binary contents of the 
  current file that is to be attached to the email</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        The encoded string containing the data.    
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!send"><!-- --></A>
   <H3>send</H3>
   <PRE>&lt;static&gt; void <B>send</B>()</PRE>
   
      <UL>Sends the email and attachments by connecting to the server and authorizing via POP.
 Restablishes the connection and sends the necessary commands to the SMTP server.  

 <p>Writes the mail headers to the socket, then schedules a task that will cause
 the data to be written in chunks to the socket. If there are any attachments 
 to be sent, the task encodes them into Base64 and writes them to the socket.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>

   <A NAME="!s!sendData"><!-- --></A>
   <H3>sendData</H3>
   <PRE>&lt;static&gt; Boolean <B>sendData</B>()</PRE>
   
      <UL>This is the task to send the attachment data, 
 which is scheduled to run by the BackgroundEmailer.send() method.</UL>
   

   <!-- METHOD PARAMETERS START -->
   
   <!-- METHOD PARAMETERS END -->

   
   <UL>
   <B>Returns:</B>
        <UL>
        True if the scheduling is to continue   
        </UL>
   </UL>
   

   <!-- ADDITIONAL ATTRIBUTES START -->
   
   <!-- ADDITIONAL ATTRIBUTES  END -->
<HR>



<!-- ============ METHOD DETAIL END ========== -->

<!-- ========= END OF CLASS DATA ========= -->

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">  <A HREF="overview-summary-BackgroundEmailer.jsx.html"><FONT CLASS="NavBarFont1"><B>File</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="overview-tree.html"><FONT CLASS="NavBarFont1"><b>Tree</b></FONT></A>&nbsp;</TD>
  <!--TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1"-->    <!--A HREF="deprecated-list.html"--><!--FONT CLASS="NavBarFont1">Deprecated</FONT--><!--/A--><!--&nbsp;</TD-->
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<B>AdobeBridgeCS6SDK</B>
</EM>
</TD
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="AsynchronousFTP.html"><B>PREV CLASS</B></A><!-- 
   NEXT CLASS 
-->
&nbsp;<A HREF="BasicEmailer.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="BackgroundEmailer.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>

<!-- =========== END OF NAVBAR =========== -->

<HR>
<FONT SIZE="-1">
http://www.adobe.com/devnet/bridge
</FONT>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Mon Jun 18 17:15:34 2012</div>
</BODY>
</HTML>
