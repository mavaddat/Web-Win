<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
AdobeBridgeCS6SDK Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="BasicExtensionHandler.jsx Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>BasicExtensionHandler.jsx</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Demonstrates a basic implementation of a node-handling extension, in which the model is read-only.
  <BR/><BR/><B>See:</B><UL>- <a href="SDKSystem.html#">SDKSystem</a><BR/>- <a href="SDKNode.html#">SDKNode</a><BR/>- <a href="CustomInfosetExtensionHandler.html#">CustomInfosetExtensionHandler</a><BR/>- <a href="CustomSearchExtensionHandler.html#">CustomSearchExtensionHandler</a><BR/>- <a href="CustomSortExtensionHandler.html#">CustomSortExtensionHandler</a></UL>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="BasicExtensionHandler.html">BasicExtensionHandler</a></b></td>
    <td>Demonstrates a basic implementation of a node-handling extension, in which the model is read-only.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">////////////////////////////////////////////////////////////////////////////</span>
<span class="comment">// ADOBE SYSTEMS INCORPORATED</span>
<span class="comment">// Copyright 2008 Adobe Systems Incorporated</span>
<span class="comment">// All Rights Reserved</span>
<span class="comment">//</span>
<span class="comment">// NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the</span>
<span class="comment">// terms of the Adobe license agreement accompanying it.  If you have received this file from a</span>
<span class="comment">// source other than Adobe, then your use, modification, or distribution of it requires the prior</span>
<span class="comment">// written permission of Adobe.</span>
<span class="comment">/////////////////////////////////////////////////////////////////////////////</span>

<span class="comment">/** 
  <span class="attrib">@fileoverview</span> Demonstrates a basic implementation of a node-handling extension, in which the model is read-only.
  <span class="attrib">@class</span> Demonstrates a basic implementation of a node-handling extension, in which the model is read-only.
 
  &lt;h4&gt;Usage&lt;/h4&gt;
  
  &lt;ol&gt;
  &lt;li&gt; Make sure the icon files required by this sample are in the ./resources folder (BEHFileIconxx.png)
  &lt;li&gt; Execute the snippet in the ExtendScript Toolkit (see Readme.txt) with Bridge CS6 as the target- you can do this only once, then you must restart Bridge.
  &lt;li&gt; In Bridge inspect in the Favorites panel and select the new icon added, which should be named "BERoot". 
  &lt;li&gt; Navigate through the node hierarchy in the Content pane
  &lt;li&gt; As each is selected inspect the JavaScript console in the ESTK to view the Thumbnail's URI.
  &lt;/ol&gt;
 
  &lt;h4&gt;Description&lt;/h4&gt;
 
&lt;p&gt;Shows how to implement an ExtensionHandler and ExtensionModel,
  using two supporting classes, SDKSystem and SDKNode.

&lt;p&gt;The main function, run(), creates several nodes of the new type, and one manager object. 
  It stores the node-identifying prefix and root node in the manager object. 
    
&lt;p&gt;The function creates the ExtensionHandler object, whose definition includes
  the 'makeModel()' method, which Bridge uses to create the ExtensionModel object 
  at node-display time. The function registers the ExtensionHandler, 
  associating it with the node-identifying prefix.
    
&lt;p&gt;These nodes have no real capabilities, so the hierarchy is read-only.  
  See the Bridge JavaScript Guide for more details of node-handling mechanisms
  you can implement.&lt;br /&gt;

  <span class="attrib">@see</span> SDKSystem
  <span class="attrib">@see</span> SDKNode
  <span class="attrib">@see</span> CustomInfosetExtensionHandler
  <span class="attrib">@see</span> CustomSearchExtensionHandler
  <span class="attrib">@see</span> CustomSortExtensionHandler
	
  <span class="attrib">@constructor</span>  Constructor.
*/</span>
<span class="reserved">function</span> BasicExtensionHandler() {

	$.level = 1; <span class="comment">// Debugging level</span>
	<span class="comment">/**
	  The context in which this sample can run.
	  <span class="attrib">@type</span> String
	*/</span>
	<span class="reserved">this</span>.requiredContext = <span class="literal">"\tNeed to be running in context of Bridge\n"</span>;		
}

<span class="comment">/**
 Functional part of this sample, creates several nodes of the new type, and one manager object,
 which stores the node-identifying prefix and root node. 
     
&lt;p&gt;Creates the ExtensionHandler object, whose definition includes
 the 'makeModel()' method, which Bridge uses to create the ExtensionModel object 
 at node-display time.
 
&lt;p&gt;Registers the ExtensionHandler, associating it with the node-identifying prefix.
 	<span class="attrib">@return</span> True if the sample ran as expected, false otherwise
 	<span class="attrib">@type</span> Boolean
*/</span>
BasicExtensionHandler.<span class="reserved">prototype</span>.run = <span class="reserved">function</span>()
{
	<span class="reserved">if</span>(!<span class="reserved">this</span>.canRun())
	{
		<span class="reserved">return</span> false;
	}
	
	$.writeln(<span class="literal">"BasicExtensionHandler: About to run"</span>);
	
	<span class="comment">// Create some nodes of the script-defined type </span>
	<span class="reserved">var</span> root = new SDKNode(<span class="literal">"BERoot"</span>, true);

	<span class="comment">// Sub node - /BERoot/EHFolder1</span>
	<span class="reserved">var</span> sub = new SDKNode(<span class="literal">"EHFolder1"</span>, true)
	root.addNode(sub);
	
	<span class="comment">// add a leaf node to the root</span>
	<span class="reserved">var</span> lf = new SDKNode(<span class="literal">"RootLeaf"</span>, false);
	root.addNode(lf);
	
	<span class="reserved">var</span> n = new SDKNode(<span class="literal">"leaf1"</span>, false);
	<span class="reserved">var</span> d = root.findChildNode(<span class="literal">"EHFolder1"</span>);
	d.addNode(n);

	<span class="comment">// Sub node - /BERoot/EHFolder2</span>
	root.addNode(new SDKNode(<span class="literal">"EHFolder2"</span>, true));
	n = new SDKNode(<span class="literal">"leaf2"</span>, false);
	d = root.findChildNode(<span class="literal">"EHFolder2"</span>);
	d.addNode(n);
	n = new SDKNode(<span class="literal">"leaf3"</span>, false);
	d = root.findChildNode(<span class="literal">"EHFolder2"</span>);
	d.addNode(n);

	<span class="comment">// /BERoot/EHFolder1/EHSubFolder1</span>
	root.getChildNode(<span class="literal">"EHFolder2"</span>).addNode(new SDKNode(<span class="literal">"EHSubFolder1"</span>, true));

	<span class="comment">// BERoot/EHFolder1/EHSubFolder1/leaf4</span>
	n = new SDKNode(<span class="literal">"leaf4"</span>, false);
	d = root.findChildNode(<span class="literal">"EHSubFolder1"</span>);
	d.addNode(n);

	<span class="comment">// Create the manager object with the node-identifying prefix, </span>
	<span class="comment">// and add the root node</span>
	<span class="reserved">var</span> sys = new SDKSystem(<span class="literal">"bridge:beNode:"</span>);
	sys.addRoot(root);
	
	<span class="comment">// Create the node extension handler object</span>
	<span class="reserved">var</span> behHandler = new ExtensionHandler(<span class="literal">"behHandler"</span>);

	<span class="comment">/**
		Required. Returns a canonical URI for the path.  If the path does not contain the 
		registered prefix, the this method must append it to the path and return it.  For example: 
		bridge:beNode:/BERoot
		<span class="attrib">@param</span> path The path of the node as a string
	*/</span>
	behHandler.getBridgeUriForPath = <span class="reserved">function</span>(path)
	{
		<span class="reserved">return</span> path;
	}

	 <span class="reserved">var</span> wrapperObject = <span class="reserved">this</span>;
	<span class="comment">/**
		Required. Creates and returns and ExtensionModel instance.  Called each time a handled node
		is displayed.  The model must also implement any methods that handle any required 
		functionality, such as renaming node.
		<span class="attrib">@return</span> An ExtensionModel for this node
		<span class="attrib">@type</span> ExtensionModel
	*/</span>
	behHandler.makeModel = <span class="reserved">function</span>(path)
	{
		behModel = new ExtensionModel(path);
		behModel.path = path;
		<span class="reserved">this</span>.path = path;
		wrapperObject.initModel(behModel, sys);
		
		<span class="reserved">return</span> behModel;
	}
	
	<span class="comment">// Register the node handler and prefix with the application</span>
	app.registerExtension(behHandler);
	app.registerPrefix( <span class="literal">"bridge:beNode:"</span>, behHandler);
	
	<span class="comment">// create a thumbnail and add it to the Favorites panel</span>
	<span class="reserved">var</span> t = new Thumbnail(<span class="literal">"bridge:beNode:/BERoot"</span>);
	app.favorites.insert(t);
	t.refresh();

	<span class="comment">// create an event handler to capture selection changes</span>
	onNodeSelect = <span class="reserved">function</span>(event)
	{
		<span class="reserved">if</span>(event.object instanceof Document &amp;&amp; event.type == <span class="literal">"selectionsChanged"</span>)
		{
			<span class="reserved">if</span>(event.object.selections.length != 0)
			{
				<span class="reserved">var</span> thumb = event.object.selections[0];
				$.writeln(<span class="literal">"BasicExtensionHandler: "</span> + thumb.uri + <span class="literal">" selected"</span>);
			}
		}
		<span class="comment">// continue with other handlers</span>
		<span class="reserved">return</span> {handled: false};
	}
	
	<span class="comment">// register the handler</span>
	app.eventHandlers.push({handler: onNodeSelect});

	$.writeln(<span class="literal">"BasicExtensionHandler: ran successfully"</span>);
	<span class="reserved">return</span> true;
}

<span class="comment">/**
  Determines whether sample can be run given current context.  The sample
  fails if these preconditions are not met:
  &lt;ul&gt;
  &lt;li&gt; Bridge must be running
  &lt;li&gt; Resource files must be available
  &lt;/ul&gt;
  <span class="attrib">@return</span> True if this sample can run, false otherwise
  <span class="attrib">@type</span> Boolean
*/</span>
BasicExtensionHandler.<span class="reserved">prototype</span>.canRun = <span class="reserved">function</span>() {
	
	<span class="reserved">if</span>(BridgeTalk.appName == <span class="literal">"bridge"</span>) 
	{
		<span class="comment">// Check that this extension handler is not already loaded</span>
		<span class="reserved">for</span>(index in app.extensions)
		{
			<span class="reserved">if</span>(app.extensions[index].name == <span class="literal">"behHandler"</span>)
			{
				$.writeln(<span class="literal">"BasicExtensionHandler: ERROR - Cannont run twice! You must restart Bridge"</span>);
				<span class="reserved">return</span> false;
			}
		}
		<span class="reserved">return</span> true;

	}
	$.writeln(<span class="literal">"BasicExtensionHandler: ERROR - Cannot run BasicExtensionHandler"</span>);
	$.writeln(<span class="literal">"BasicExtensionHandler: "</span> + <span class="reserved">this</span>.requiredContext);
	<span class="reserved">return</span> false;
}

<span class="comment">/**
	Initialize the model and define the methods that this model supports
	<span class="attrib">@param</span> behModel The model for the handled nodes
	<span class="attrib">@param</span> sys The manager object for the handled nodes
*/</span>
BasicExtensionHandler.<span class="reserved">prototype</span>.initModel = <span class="reserved">function</span>(behModel, sys)
{
		<span class="comment">/**
			Required.  Carries out any necessary authentication.
		*/</span>
		behModel.authenticate = <span class="reserved">function</span>()
		{
			<span class="reserved">return</span>;
		}
	
		<span class="comment">/**
			Required,  Checks if this node is a valid node.
			<span class="attrib">@return</span> True if this node is valid, false if otherwise
			<span class="attrib">@type</span> Boolean
		*/</span>			
		behModel.exists = <span class="reserved">function</span>()
		{
			<span class="reserved">return</span> true;
		}

		<span class="comment">/**
			Required.  Called after the model is created, sets up any necessary data structures
			that may be needed.
		*/</span>
		behModel.initialize = <span class="reserved">function</span>()
		{
			<span class="reserved">this</span>.privateData.node = sys.getNodeFromPath(<span class="reserved">this</span>.path);
		}
		
		<span class="comment">/**
			Required.  Stores a back pointer to the cache that contains this model.
			<span class="attrib">@param</span> cacheEelement The CacheElement that contains this model.
		*/</span>
		behModel.registerInterest = <span class="reserved">function</span>(cacheElement)
		{
			<span class="reserved">this</span>.privateData.cacheElement = cacheElement;
		}
		
		<span class="comment">/**
			Required. Removes the association between the CacheElement and
			this model instance.
		*/</span>
		behModel.unregisterInterest = <span class="reserved">function</span>()
		{
			<span class="reserved">this</span>.privateData.cacheElement = undefined;
		}
	
		<span class="comment">/**
			Returns the parent of this node
		*/</span>
		behModel.getParent = <span class="reserved">function</span>()
		{
			<span class="reserved">var</span> parent = <span class="reserved">this</span>.privateData.node.getParent();
			<span class="reserved">if</span>(parent != undefined)
			{
				<span class="reserved">return</span> (sys.getPrefix() + parent.getPath());
			}
		}
		
		<span class="comment">/**
			Required.  Updates the core node data and any custom node data
			for this node.  Always set the CacheData.status after updating the node data.
			<span class="attrib">@param</span> infosetName The name of the Infoset that is being updated.
		*/</span>
		behModel.refreshInfoset = <span class="reserved">function</span>(infosetName)
		{
			<span class="reserved">var</span> infoset = <span class="reserved">this</span>.privateData.cacheElement[infosetName];
			<span class="reserved">var</span> currentNode = <span class="reserved">this</span>.privateData.node;
			try
			{
				<span class="reserved">if</span>(infosetName == <span class="literal">"immediate"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.name = currentNode.getName();
					infoset.isContainer = currentNode.isContainer();
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}

				<span class="comment">// The capabilities of a handled node</span>
				<span class="reserved">if</span>(infosetName == <span class="literal">"item"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}

				<span class="comment">// Add any children of this node to the children infoset</span>
				<span class="reserved">if</span>(infosetName == <span class="literal">"children"</span> || infosetName == <span class="literal">"all"</span>)
				{
					<span class="reserved">var</span> arr = currentNode.getChildren();
					<span class="reserved">for</span>(<span class="reserved">var</span> j = 0;j &lt; arr.length;j++)
					{
						infoset.addChild( sys.getPrefix() + arr[j].getPath() );
					}
							
					infoset.cacheData.status = <span class="literal">"good"</span>; 			
				}

				<span class="reserved">if</span>(infosetName == <span class="literal">"icon"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.bitmap = currentNode.getIcon();
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}

				<span class="reserved">if</span>(infosetName == <span class="literal">"thumbnail"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.thumbnail = currentNode.getThumb();
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}

				<span class="reserved">if</span>(infosetName == <span class="literal">"quickMetadata"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.colorMode = -1;
					infoset.hasRawSetting = false;
					infoset.hasCrop = false;
					infoset.height = 300;
					infoset.rating = 0;
					infoset.rotation = 0;
					infoset.stockPhotoStatus = 0;
					infoset.xResolution = 0;
					infoset.yResolution = 0;
					infoset.width = 300;
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}
 
				<span class="reserved">if</span>(infosetName == <span class="literal">"itemContent"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.canGetPreview = false;
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}
	  
				<span class="reserved">if</span>(infosetName == <span class="literal">"preview"</span> || infosetName == <span class="literal">"all"</span>)
				{
					infoset.preview = currentNode.getPreview();
					infoset.cacheData.status = <span class="literal">"good"</span>;
				}

			} catch(error) { alert(error); }			

		} <span class="comment">// end refrreshInfoset</span>

		<span class="comment">/**
			Required.  Returns the cache status of a node data set.
			<span class="attrib">@param</span> infosetName The name of the Infoset in which to check the cache status		
		*/</span>
		behModel.getCacheStatus = <span class="reserved">function</span>( infosetName, cookie )
		{
			<span class="reserved">if</span>(typeof <span class="reserved">this</span>.privateData.cacheElement == <span class="literal">"undefined"</span>)
			{
				<span class="reserved">return</span> <span class="literal">"bad"</span>;
			}

			<span class="reserved">if</span>(typeof <span class="reserved">this</span>.privateData.cacheElement.infosetName== <span class="literal">"undefined"</span>)
			{
				<span class="reserved">var</span> ce = <span class="reserved">this</span>.privateData.cacheElement;
				<span class="reserved">var</span> info = ce[infosetName];
				<span class="reserved">var</span> cd = info.cacheData;
				<span class="reserved">var</span> stat = cd.status;
				<span class="reserved">return</span> stat;
			}
			<span class="reserved">return</span> <span class="reserved">this</span>.privateData.cacheElement[infosetName].cacheData.status;
		}
		
		<span class="comment">/**
			Required.  Acts as a destructor for this instance.  Return 'undefined' from 
			this method. Any private data structures will be cleaned automatically
		*/</span>
		behModel.terminate = <span class="reserved">function</span>()
		{
			<span class="reserved">return</span>;
		}	
}	

<span class="comment">// Include the support classes</span>
#include SDKSystem.jsx
#include SDKNode.jsx

<span class="comment">/**
  "main program": construct an anonymous instance and run it
*/</span>
<span class="reserved">if</span>(typeof(BasicExtensionHandler_unitTest) == <span class="literal">"undefined"</span>) {
	new BasicExtensionHandler().run();
}</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">
http://www.adobe.com/devnet/bridge
</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Mon Jun 18 17:15:34 2012</div>
</body>
</html>
