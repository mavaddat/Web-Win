<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
AdobeBridgeCS6SDK Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="SnpInspectMetadata.jsx Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>SnpInspectMetadata.jsx</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Shows how to acquire metadata for a selected thumbnail using XMP external object.
  <BR/><BR/><B>See:</B><UL>- <a href="SnpInspectMetadata.html#">SnpInspectMetadata</a><BR/>- <a href="SnpModifyMetadata.html#">SnpModifyMetadata</a></UL>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="SnpInspectMetadata.html">SnpInspectMetadata</a></b></td>
    <td>Shows how to acquire metadata for a selected thumbnail using XMP external object.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">////////////////////////////////////////////////////////////////////////////</span>
<span class="comment">// ADOBE SYSTEMS INCORPORATED</span>
<span class="comment">// Copyright 2008 Adobe Systems Incorporated</span>
<span class="comment">// All Rights Reserved</span>
<span class="comment">//</span>
<span class="comment">// NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the</span>
<span class="comment">// terms of the Adobe license agreement accompanying it.  If you have received this file from a</span>
<span class="comment">// source other than Adobe, then your use, modification, or distribution of it requires the prior</span>
<span class="comment">// written permission of Adobe.</span>
<span class="comment">/////////////////////////////////////////////////////////////////////////////</span>

<span class="comment">/** 
 <span class="attrib">@fileoverview</span> Shows how to acquire metadata for a selected thumbnail using XMP external object.
  <span class="attrib">@class</span> Shows how to acquire metadata for a selected thumbnail using XMP external object.
 
 &lt;h4&gt;Usage&lt;/h4&gt;
 	   
   
   &lt;ol&gt;
   &lt;li&gt;Open the snippet in the ExtendScript Toolkit (see Readme.txt), setting Bridge CS6 as the target application
     &lt;li&gt; In Bridge, select a single thumbnail that has metadata, such as an Adobe PDF, Adobe Photoshop CS6 (PSD) or Adobe InDesign CS6 (INDD).
     &lt;li&gt; Go back to the ExtendScript Toolkit and run the snippet.
     &lt;li&gt;Inspect the JavaScript Console of the Toolkit; you should see information about the XMP-based metadata of the thumbnail selected.
  &lt;/ol&gt;
	 
 &lt;h4&gt;Description&lt;/h4&gt;

&lt;p&gt;Shows how to acquire XMP metadata for a selected thumbnail by creating an XMPMeta object
  and retrieving XMP properties.
  
&lt;p&gt;The File object that is represented by the selected Thumbnail in Bridge is used to create a read only
	XMPFile object, which in turn gives the XMPMeta object.  Several properties are inspected from different
	namespaces and displayed via the JavaScript console.  
	
&lt;p&gt;One of the properties inspected is an alternative array  (language alternative) which may have several 
	qualifiers.  This sample demonstrates how to access the qualifier directly as well as how to select the
	localized text.
  
 &lt;p&gt;See the XMP section in the JavaScript Tools Guide for more details.&lt;br /&gt;

 <span class="attrib">@see</span> SnpInspectMetadata
 <span class="attrib">@see</span> SnpModifyMetadata
 
  <span class="attrib">@constructor</span> Constructor
 */</span>
<span class="reserved">function</span> SnpInspectMetadata() 
{

	<span class="comment">/**
	 The context in which this snippet can run.
	 <span class="attrib">@type</span> String
	*/</span>
	<span class="reserved">this</span>.requiredContext = <span class="literal">"Needs to run in Bridge, \nwith a selection of a file, \nideally with some metadata"</span>;	
}

<span class="comment">/**
 Functional part of this snippet.  Get the selected Thumbnail and creates an XMPFile object which
 is used to get access to the XMP data.
 
 <span class="attrib">@return</span> True if the snippet ran as expected, false otherwise
 <span class="attrib">@type</span> boolean
*/</span>
SnpInspectMetadata.<span class="reserved">prototype</span>.run = <span class="reserved">function</span>() 
{
	<span class="reserved">if</span>(!<span class="reserved">this</span>.canRun())
	{
		<span class="reserved">return</span> false;
	}

	<span class="comment">// Load the XMP Script library</span>
	<span class="reserved">if</span>( xmpLib == undefined ) 
	{
		<span class="reserved">if</span>( Folder.fs == <span class="literal">"Windows"</span> )
		{
			<span class="reserved">var</span> pathToLib = Folder.startup.fsName + <span class="literal">"/AdobeXMPScript.dll"</span>;
		} 
		<span class="reserved">else</span> 
		{
			<span class="reserved">var</span> pathToLib = Folder.startup.fsName + <span class="literal">"/AdobeXMPScript.framework"</span>;
		}
	
		<span class="reserved">var</span> libfile = new File( pathToLib );
		<span class="reserved">var</span> xmpLib = new ExternalObject(<span class="literal">"lib:"</span> + pathToLib );
	}

	$.writeln(<span class="literal">"About to run SnpInspectMetadata"</span>);
	
	<span class="reserved">var</span> thumb = app.document.selections[0];
	<span class="reserved">if</span>(thumb.hasMetadata)
	{
	
		<span class="comment">// Get the selected file</span>
		<span class="reserved">var</span> selectedFile = thumb.spec;
		
		<span class="comment">// Create an XMPFile</span>
		<span class="reserved">var</span> myXmpFile = new XMPFile( selectedFile.fsName, XMPConst.UNKNOWN, XMPConst.OPEN_FOR_READ);
		
		<span class="comment">// Get the XMP data</span>
		<span class="reserved">var</span> myXmp = myXmpFile.getXMP();
		
		<span class="reserved">var</span> fileInfo = myXmpFile.getFileInfo();
		$.writeln(<span class="literal">"XMP contents for "</span> + fileInfo.filePath);
		$.writeln(<span class="literal">"\n---------------------"</span>); 
		
		$.writeln(<span class="literal">"PDF Schema - "</span> + XMPConst.NS_PDF);
		<span class="reserved">var</span> prop = myXmp.getProperty(XMPConst.NS_PDF, <span class="literal">"Keywords"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tKeywords: "</span> + prop);
		
		prop = myXmp.getProperty(XMPConst.NS_PDF, <span class="literal">"Copyright"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tCopyright: "</span> + prop);
		
		prop = myXmp.getProperty(XMPConst.NS_PDF, <span class="literal">"Producer"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tProducer: "</span> + prop);
		
		$.writeln(<span class="literal">"\n---------------------"</span>); 
		
		$.writeln(<span class="literal">"XMP Basic - "</span> + XMPConst.NS_XMP);
		prop = myXmp.getProperty(XMPConst.NS_XMP, <span class="literal">"MetadataDate"</span>, XMPConst.XMPDATE);
		$.writeln(<span class="literal">"\tMetadataDate: "</span> + prop);
		
		prop = myXmp.getProperty(XMPConst.NS_XMP, <span class="literal">"CreatorTool"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tCreatorTool: "</span> + prop);
		
		prop = myXmp.getProperty(XMPConst.NS_XMP, <span class="literal">"CreateDate"</span>);
		$.writeln(<span class="literal">"\tCreateDate: "</span> + prop);
		
		$.writeln(<span class="literal">"\n---------------------"</span>); 
		
		$.writeln(<span class="literal">"Dublin Core - "</span> + XMPConst.NS_DC);
		dumpArrayItems(XMPConst.NS_DC, <span class="literal">"description"</span>);
		dumpArrayItems(XMPConst.NS_DC, <span class="literal">"title"</span>);
		dumpArrayItems(XMPConst.NS_DC, <span class="literal">"creator"</span>);
		
		$.writeln(<span class="literal">"\n---------------------"</span>); 
		
		$.writeln(<span class="literal">"XMP Asset Management - "</span> + XMPConst.NS_XMP_MM);
		prop = myXmp.getProperty(XMPConst.NS_XMP_MM, <span class="literal">"InstanceID"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tInstanceID: \n\t  "</span> + prop);
		
		prop = myXmp.getProperty(XMPConst.NS_XMP_MM, <span class="literal">"DocumentID"</span>, XMPConst.STRING);
		$.writeln(<span class="literal">"\tDocumentID: \n\t  "</span> + prop);
		
		$.writeln(<span class="literal">"\n---------------------"</span>); 
		$.writeln(<span class="literal">"Getting some localized text:"</span>);
		<span class="reserved">var</span> localizedText = myXmp.getLocalizedText(XMPConst.NS_DC,<span class="literal">"title"</span>, null, <span class="literal">"it-IT"</span>);
		$.writeln(<span class="literal">"\tItalian: "</span> + localizedText);
		
		<span class="reserved">var</span> localizedText = myXmp.getLocalizedText(XMPConst.NS_DC,<span class="literal">"title"</span>, null, <span class="literal">"fr-FR"</span>);
		$.writeln(<span class="literal">"\tFrench: "</span> + localizedText);
		
		<span class="reserved">var</span> localizedText = myXmp.getLocalizedText(XMPConst.NS_DC,<span class="literal">"title"</span>, null, <span class="literal">"en-US"</span>);
		$.writeln(<span class="literal">"\tEnglish: "</span> + localizedText);

		
	}
	<span class="reserved">else</span>
	{
		$.writeln(<span class="literal">"The selected thumbnail has no metadata."</span>);
	}

	<span class="comment">// Helper function to dump array items and qualifiers</span>
	<span class="reserved">function</span> dumpArrayItems(ns, prop)
	{
		<span class="reserved">var</span> items = myXmp.countArrayItems(ns, prop);
		<span class="reserved">if</span>(items &gt; 0)
		{		
			$.writeln(<span class="literal">"\t"</span> + prop + <span class="literal">": "</span>);
			<span class="reserved">for</span>(<span class="reserved">var</span> i = 1;i &lt;= items;i++)
			{
					arrItem = myXmp.getArrayItem(XMPConst.NS_DC, prop, i);
					$.writeln(<span class="literal">"\t  ["</span> + i + <span class="literal">"] = "</span> + arrItem);
					<span class="reserved">if</span>((arrItem.options &amp; XMPConst.PROP_HAS_QUALIFIERS) &gt; 0)
					{
						<span class="reserved">var</span> propName = prop + <span class="literal">"["</span> + i + <span class="literal">"]"</span>;
						<span class="reserved">var</span> val = myXmp.getQualifier(XMPConst.NS_DC, propName, <span class="literal">"http://www.w3.org/XML/1998/namespace"</span>, <span class="literal">"lang"</span>);
						$.writeln(<span class="literal">"\t    xml:lang = '"</span> + val + <span class="literal">"'"</span>);
					}
			}
		}
		<span class="reserved">else</span>
		{
			$.writeln(<span class="literal">"\t"</span> + prop + <span class="literal">"\n\t  No data"</span>);
		}
	
		$.writeln();
	}

	$.writeln(<span class="literal">"Ran SnpInspectMetadata"</span>);
	
	<span class="reserved">return</span> true;
}

<span class="comment">/**
  Determines whether snippet can be run given current context.  The snippet 
  fails if these preconditions are not met:
  &lt;ul&gt;
  &lt;li&gt; Must be running in Bridge
  &lt;li&gt; A selection must be made in the Content pane of Bridge 
  &lt;/ul&gt;

  <span class="attrib">@return</span> True is this snippet can run, false otherwise
  <span class="attrib">@type</span> boolean
*/</span>
SnpInspectMetadata.<span class="reserved">prototype</span>.canRun = <span class="reserved">function</span>()
 {
	<span class="comment">// Must be running in Bridge &amp; have a selection</span>
	<span class="reserved">if</span>( (BridgeTalk.appName == <span class="literal">"bridge"</span>) &amp;&amp; (app.document.selectionsLength == 1)) {
		<span class="reserved">return</span> true;
	}

	$.writeln(<span class="literal">"ERROR:: Cannot run SnpInspectMetadata"</span>);
	$.writeln(<span class="reserved">this</span>.requiredContext);
	<span class="reserved">return</span> false;
}

<span class="comment">/**
 "main program": construct an anonymous instance and run it
  as long as we are not unit-testing this snippet.
*/</span>
<span class="reserved">if</span>(typeof(SnpInspectMetadata_unitTest ) == <span class="literal">"undefined"</span>) {
	new SnpInspectMetadata().run();
}
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">
http://www.adobe.com/devnet/bridge
</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Mon Jun 18 17:15:34 2012</div>
</body>
</html>
