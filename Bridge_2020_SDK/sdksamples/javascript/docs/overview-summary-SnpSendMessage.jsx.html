<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
AdobeBridgeCS6SDK Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="SnpSendMessage.jsx Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>SnpSendMessage.jsx</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Demonstrates basic cross-application communication using BridgeTalk messages, between Bridge CS6 and Photoshop CS6.
  <BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="SnpSendMessage.html">SnpSendMessage</a></b></td>
    <td>Demonstrates basic cross-application communication using BridgeTalk messages, between Bridge CS6 and Photoshop CS6.</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">////////////////////////////////////////////////////////////////////////////</span>
<span class="comment">// ADOBE SYSTEMS INCORPORATED</span>
<span class="comment">// Copyright 2008 Adobe Systems Incorporated</span>
<span class="comment">// All Rights Reserved</span>
<span class="comment">//</span>
<span class="comment">// NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the</span>
<span class="comment">// terms of the Adobe license agreement accompanying it.  If you have received this file from a</span>
<span class="comment">// source other than Adobe, then your use, modification, or distribution of it requires the prior</span>
<span class="comment">// written permission of Adobe.</span>
<span class="comment">/////////////////////////////////////////////////////////////////////////////</span>

<span class="comment">/** 
  <span class="attrib">@fileoverview</span> Demonstrates basic cross-application communication using BridgeTalk messages, between Bridge CS6 and Photoshop CS6.
  <span class="attrib">@class</span> Demonstrates basic cross-application communication using BridgeTalk messages, between Bridge CS6 and Photoshop CS6.
  
  &lt;h4&gt;Usage&lt;/h4&gt;
  &lt;ol&gt;
  &lt;li&gt; Make sure Adobe Bridge CS6 and Adobe Photoshop CS6 are running
  &lt;li&gt; Run the snippet in the ExtendScript Toolkit (ESTK), 
       with Bridge as the target (see Readme.txt)
  &lt;li&gt; Inspect the JavaScript Console in the ESTK to see the sequence of messages passing between Bridge CS6 and Photoshop CS6.
  &lt;li&gt;Note; there is no other visible output besides the trace to the JavaScript Console of the ESTK.
  &lt;/ol&gt;

  &lt;h4&gt;Description&lt;/h4&gt;

  &lt;p&gt;This script creates a BridgeTalk message object and sends it from Bridge to Photoshop.
  It prints to the JavaScript Console so you can see the order of arrival of the
  message and message responses.

  &lt;p&gt;Adobe Bridge CS6 and Adobe Photoshop CS6 must be running for this script to work. When Photoshop receives 
  the  message from Bridge, its default BridgeTalk.onReceive() method evaluates the script
  contained in the message body. That script causes Photoshop to send create some BridgeTalk 
  messages and send them back to Bridge.&lt;br /&gt;
 
  <span class="attrib">@constructor</span>
  Constructor.
 */</span>
<span class="reserved">function</span> SnpSendMessage() {
	
	<span class="comment">/**
	 The number of messages to send back from Photoshop.
	 <span class="attrib">@type</span> int
	*/</span>
	<span class="reserved">this</span>.numberOfMessagesToSend = 4;
	
	<span class="comment">/**
	 The context in which this snippet can run.
	 <span class="attrib">@type</span> String
	*/</span>
	<span class="reserved">this</span>.requiredContext = <span class="literal">"\tExecute against Bridge 2.0 main engine,\n Photoshop must also be running."</span>;
	$.level = 1; <span class="comment">// Debugging level	</span>
}

<span class="comment">/**
 Functional part of this snippet.  
 
 Constructs the BridgeTalk message, including an onResult callback,
 and passes it to Photoshop.

 <span class="attrib">@return</span> True if the snippet ran as expected, false otherwise.  
 <span class="attrib">@type</span> Boolean
*/</span>
SnpSendMessage.<span class="reserved">prototype</span>.run = <span class="reserved">function</span>() {
	<span class="reserved">var</span> retval = true;
	<span class="reserved">if</span>(!<span class="reserved">this</span>.canRun()) {
		retval = false;	
		<span class="reserved">return</span> retval;
	}
	<span class="comment">// Override the default static BridgeTalk.onReceive() function</span>
	<span class="comment">// for Bridge to add functionality.</span>
	BridgeTalk.onReceive = <span class="reserved">function</span>( msg ) {
		<span class="comment">// this is added to the default action</span>
		$.writeln(<span class="literal">"SnpSendMessage: In Bridge - received message = "</span> + msg.body);
		<span class="comment">// this is the default action</span>
		retval = eval(msg.body);
		<span class="reserved">return</span> retval;
	}
	
	
	<span class="comment">// Build a string containing the script to be executed </span>
	<span class="comment">// by the target application (Photoshop)</span>
	<span class="reserved">var</span> scp = <span class="literal">"for(var i = 1; i &lt;= "</span> + <span class="reserved">this</span>.numberOfMessagesToSend + <span class="literal">"; i++) {\n"</span>; 
	scp += <span class="literal">"var bt = new BridgeTalk();\n"</span>;
	<span class="comment">// Photoshop is going to send a message back to Bridge, so</span>
	<span class="comment">// when Photoshop is the sender, the target is Bridge</span>
	scp += <span class="literal">"bt.target = 'bridge';\n"</span>; 
	scp += <span class="literal">"var msgbody = 'var message_index = ' + i; "</span>;
	scp += <span class="literal">"bt.body = msgbody;\n"</span>;
	<span class="comment">// Photoshop will acknowledge the Bridge response to each successful message</span>
	scp += <span class="literal">"bt.onResult = function( resultMsg )\n { $.writeln('SnpSendMessage: In Photoshop - response to message sent back to Bridge = ' + resultMsg.body); }\n"</span>;
	<span class="comment">// Photoshop will acknowledge any errors that occur while sending back messages</span>
	scp += <span class="literal">"bt.onError = function( errorMsg )\n { $.writeln('SnpSendMessage: ERROR In Photoshop: error = ' + errorMsg.body); }\n"</span>;
	scp += <span class="literal">"$.writeln('In Photoshop: about to send message ' + i + ' to Bridge');\n"</span>
	scp += <span class="literal">"bt.send();\n"</span>
	scp += <span class="literal">"}"</span>; <span class="comment">// end for</span>
	
	<span class="comment">// Bridge creates the initial message object </span>
	<span class="reserved">var</span> btMsg = new BridgeTalk();
	<span class="comment">// Photoshop is the target</span>
	btMsg.target = <span class="literal">"photoshop"</span>;
	<span class="comment">// The string containing the script is the body</span>
	btMsg.body = scp;
	
	<span class="comment">// Bridge acknowledges the successful sending of the initial message</span>
	btMsg.onResult = <span class="reserved">function</span>( resultMsg ) {
		$.writeln(<span class="literal">"SnpSendMessage: In Bridge - result of sending initial message to Photoshop = "</span> + resultMsg.body);
	}
	
	<span class="comment">// Bridge handles any errors  that occur when sending the initial message</span>
	btMsg.onError = <span class="reserved">function</span>( errorMsg ) {
		 retval = false; 
		 $.writeln(eObj.body); 
	}
	<span class="comment">// Bridge sends the initial message</span>
	$.writeln(<span class="literal">"SnpSendMessage: In Bridge - about to send initial message to Photoshop"</span>);
	btMsg.send();
	 
	$.writeln(<span class="literal">"SnpSendMessage: In Bridge - BridgeTalk.send() invoked, SnpSendMessage.run() exiting"</span>);
	
	<span class="reserved">return</span> retval;
}

<span class="comment">/**
 Determines whether snippet can be run given current context.  The snippet 
 fails if these preconditions are not met:
 &lt;ul&gt;
 &lt;li&gt; Must run in Bridge
 &lt;li&gt; Photoshop must be running
 &lt;/ul&gt;

 <span class="attrib">@return</span> True if this snippet can run, false otherwise
 <span class="attrib">@type</span> Boolean
*/</span>
SnpSendMessage.<span class="reserved">prototype</span>.canRun = <span class="reserved">function</span>() {
	<span class="comment">// Must run in Bridge </span>
	<span class="comment">// Photoshop must be running</span>
	<span class="reserved">if</span>((BridgeTalk.appName == <span class="literal">"bridge"</span>) &amp;&amp; BridgeTalk.isRunning(<span class="literal">"photoshop"</span>)) {
		<span class="reserved">return</span> true;
	}
	<span class="comment">// Fail if these preconditions are not met. </span>
	$.writeln(<span class="literal">"ERROR:: Cannot run SnpSendMessage"</span>);
	$.writeln(<span class="reserved">this</span>.requiredContext);
	<span class="reserved">return</span> false;
}

<span class="comment">/**
 "main program": construct an anonymous instance and run it
  as long as we are not unit-testing this snippet.
*/</span>
<span class="reserved">if</span>(typeof(SnpSendMessage_unitTest)  == <span class="literal">"undefined"</span>) {
    new SnpSendMessage().run();
}





</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>AdobeBridgeCS6SDK</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">
http://www.adobe.com/devnet/bridge
</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Mon Jun 18 17:15:34 2012</div>
</body>
</html>
